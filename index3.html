<!DOCTYPE html>
<html lang="fa">
<head>
  <title>زندگی خوره‌ای</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/png" href="https://mamins1376.github.io/weblog/favicon.png">

  <link href="https://mamins1376.github.io/weblog/atom.xml" type="application/atom+xml" rel="alternate" title="خوراک اتم کامل زندگی خوره‌ای" />
  <link href="https://mamins1376.github.io/weblog/rss.xml" type="application/rss+xml" rel="alternate" title="خوراک آراس‌اس کامل زندگی خوره‌ای" />

      <link href="https://mamins1376.github.io/weblog/theme/css/style.css" rel="stylesheet" />
      <link href="https://mamins1376.github.io/weblog/theme/css/syntax.css" rel="stylesheet" />
      <link href="https://mamins1376.github.io/weblog/theme/css/fonts.css" rel="stylesheet" />
      <link href="https://mamins1376.github.io/weblog/theme/css/minimal.css" media="(max-width: 800px)" rel="stylesheet" />
</head>
<body class='rtl'>
  <div class='container'>

<header class="site-header">
<div class="wrapper">
  <a class="site-title" href="https://mamins1376.github.io/weblog">زندگی خوره‌ای</a>
  <span class="site-desc">نتیجه یکسری تعادل شیمیایی</span>
  <nav class="site-navigation">
    <!--a class="page-link" href="https://mamins1376.github.io/weblog/categories.html">دسته‌ها</a-->
    <!--a class="page-link" href="https://mamins1376.github.io/weblog/tags.html">برچسب‌ها</a-->

    <a href="https://github.com/mamins1376">گیت‌هاب</a>

    <a href="http://telegram.me/mamins1376">تلگرام</a>



    <a href="https://twitter.com/mamins1376">توئیتر</a>

    <a class="page-link" href="https://mamins1376.github.io/weblog/pages/drbrh/">درباره</a>
  </nav>
</div>
</header>
    <div class="wrapper">
<section class="content">

<ul class="post-list">
    <li><article class="post">
      <header class="post-header"><h2 class="post-title"><a href="https://mamins1376.github.io/weblog/2015/05/ary2-w-pt-srty-dwchndn/" rel="bookmark" title="آریا۲ و اپت: سرعتی دوچندان">آریا۲ و اپت: سرعتی دوچندان</a></h2>
        <abbr class="publish-date" title="تاریخ انتشار"> سه‌شنبه ۱۵ اردی‌بهشت ۱۳۹۴</abbr>
        <address class="vcard author">
            <a class="url fn" href="https://mamins1376.github.io/weblog/author/mhmdmyn.html">محمدامین</a>
        </address>
      </header>
      <div class="post-content"><p>یکی از مشکلات کاربران دبیان-بیس‌ها، سرعت apt در امر طاقت‌فرسای دانلوده که باعث می‌شه خیلی‌ها سراغ مواردی مثل apt-fast برن. ما با ترکیب آریا۲ و اپت، یه دانلود کننده‌ی توپ می‌سازیم.
<!-- ادامه --></p>
<p><strong>نکته مهم:</strong> هر دستوری که اولش علامت <code>#</code> رو می‌بینید به دسترسی روت نیاز داره و هر دستوری که اولش علامت <code>$</code> رو داره،‌ یعنی هر کاربری توانایی اجراش رو داره و دسترسی روت لازم نیست.</p>
<h4>۱. استخراج لینک‌ها</h4>
<p>مسلماً بسته‌های دبیان چیزی جز فایل نیستن و apt هم این «فایل»ها رو دانلود می‌کنه. خب وقتی خودش می‌تونه دانلود کنه،‌ چرا ما نتونیم؟ خوش‌بختانه برای همچین‌کاری یه سوئیچ خوب وجود داره:</p>
<div class="highlight"><pre><span></span>root@debian:~# apt-get -y --print-uris <span class="o">{</span> install &lt;PACKAGE&gt; <span class="p">|</span> upgrade <span class="p">|</span> ... <span class="o">}</span>
</pre></div>


<p>این سوئیچ به apt می‌گه که فقط لینک رو بنویس و بی‌خیال دانلود شو. سوئیچ <code>y</code> هم می‌گه که خودت تائید کن.
مثلا من guake رو امتحان می‌کنم:</p>
<div class="highlight"><pre><span></span>root@debian:~# apt-get -y --print-uris install guake 
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following extra packages will be installed:
  python-glade2 python-vte
Suggested packages:
  python-gtk2-doc
The following NEW packages will be installed:
  guake python-glade2 python-vte
<span class="m">0</span> upgraded, <span class="m">3</span> newly installed, <span class="m">0</span> to remove and <span class="m">0</span> not upgraded.
Need to get <span class="m">201</span> kB of archives.
After this operation, 1,381 kB of additional disk space will be used.
<span class="s1">&#39;http://ir.archive.ubuntu.com/ubuntu/pool/main/v/vte/python-vte_0.28.2-5ubuntu1_amd64.deb&#39;</span> python-vte_1%3a0.28.2-5ubuntu1_amd64.deb <span class="m">21726</span> MD5Sum:a0b9e19f09fa001ca3e75534a5298c51
<span class="s1">&#39;http://ir.archive.ubuntu.com/ubuntu/pool/main/p/pygtk/python-glade2_2.24.0-3ubuntu3_amd64.deb&#39;</span> python-glade2_2.24.0-3ubuntu3_amd64.deb <span class="m">8744</span> MD5Sum:1aef0e4a843eac23ffc619bc02382f03
<span class="s1">&#39;http://ir.archive.ubuntu.com/ubuntu/pool/universe/g/guake/guake_0.4.4-1ubuntu1_amd64.deb&#39;</span> guake_0.4.4-1ubuntu1_amd64.deb <span class="m">171024</span> MD5Sum:a24f28469f7a83debc4aed2ec6ea1515
</pre></div>


<p>اطلاعاتی که ما لازم داریم سه خط آخر هستن که وجه اشتراکشون <code>//:http</code> ابتداشونه. پس با <code>grep</code> فیلترشون می‌کنیم:</p>
<div class="highlight"><pre><span></span>root@debian:~# apt-get --print-uris -y install guake <span class="p">|</span> grep <span class="s1">&#39;http://&#39;</span>
<span class="s1">&#39;http://ir.archive.ubuntu.com/ubuntu/pool/main/v/vte/python-vte_0.28.2-5ubuntu1_amd64.deb&#39;</span> python-vte_1%3a0.28.2-5ubuntu1_amd64.deb <span class="m">21726</span> MD5Sum:a0b9e19f09fa001ca3e75534a5298c51
<span class="s1">&#39;http://ir.archive.ubuntu.com/ubuntu/pool/main/p/pygtk/python-glade2_2.24.0-3ubuntu3_amd64.deb&#39;</span> python-glade2_2.24.0-3ubuntu3_amd64.deb <span class="m">8744</span> MD5Sum:1aef0e4a843eac23ffc619bc02382f03
<span class="s1">&#39;http://ir.archive.ubuntu.com/ubuntu/pool/universe/g/guake/guake_0.4.4-1ubuntu1_amd64.deb&#39;</span> guake_0.4.4-1ubuntu1_amd64.deb <span class="m">171024</span> MD5Sum:a24f28469f7a83debc4aed2ec6ea1515
</pre></div>


<p>ولی ما فقط اون قسمتی که لینک فایل توش هست رو نیاز داریم؛ پس اون‌رو هم با <code>cut</code> فیلتر می‌کنیم:</p>
<div class="highlight"><pre><span></span>root@debian:~# apt-get --print-uris -y install guake <span class="p">|</span> grep <span class="s1">&#39;http://&#39;</span> <span class="p">|</span> cut -d<span class="se">\&#39;</span> -f2
http://ir.archive.ubuntu.com/ubuntu/pool/main/v/vte/python-vte_0.28.2-5ubuntu1_amd64.deb
http://ir.archive.ubuntu.com/ubuntu/pool/main/p/pygtk/python-glade2_2.24.0-3ubuntu3_amd64.deb
http://ir.archive.ubuntu.com/ubuntu/pool/universe/g/guake/guake_0.4.4-1ubuntu1_amd64.deb
</pre></div>


<p>این‌جا <code>cut</code> متن رو بر اساس کاراکتر ‍<code>'</code> تقسیم می‌کنه. لینکی که ما لازم داریم میشه ستون دوم.<br />
حالا لینک ها رو داریم. می‌ریزیمشون توی یه فایل به اسم <code>Links.txt</code>:</p>
<div class="highlight"><pre><span></span>root@debian:~# apt-get --print-uris -y install guake <span class="p">|</span> grep <span class="s1">&#39;http://&#39;</span> <span class="p">|</span> cut -d<span class="se">\&#39;</span> -f2 &gt; Links.txt
</pre></div>


<h4>۲. دانلود بسته‌ها</h4>
<p>برای این کار از <code>aria2</code> استفاده می‌کنیم.</p>
<div class="highlight"><pre><span></span>root@debian:~# aria2c -d /var/cache/apt/archives/ -i Links.txt -s <span class="m">16</span> -x <span class="m">16</span> -c
</pre></div>


<p>سوئیچ <code>d</code> مسیری که فایل‌های دانلود شده در اون ریخته می‌شن رو مشخص می‌کنه. ‍<code>i</code> هم مسیر لینک‌ها رو. بقیه‌ی سوئیچ‌ها هم که رایج هستن و مربوط تعداد اتصال‌ها و سرعت دانلود می‌شن.</p>
<h4>۳. نصب بسته ها</h4>
<p>همیشه اپت بسته‌ها رو توی مسیر <code>/var/cache/apt/archives/</code> می‌ریزه. خب، ما که خودمون این کار رو با aria2 کردیم! پس دیگه apt نیازی به دانلود نداره.</p>
<div class="highlight"><pre><span></span>root@debian:~# apt-get -y install guake
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following extra packages will be installed:
  python-glade2 python-vte
Suggested packages:
  python-gtk2-doc
The following NEW packages will be installed:
  guake python-glade2 python-vte
<span class="m">0</span> upgraded, <span class="m">3</span> newly installed, <span class="m">0</span> to remove and <span class="m">0</span> not upgraded.
Need to get <span class="m">0</span> B/201 kB of archives.
After this operation, 1,381 kB of additional disk space will be used.
Selecting previously unselected package python-vte.
<span class="o">(</span>Reading database ... <span class="m">240702</span> files and directories currently installed.<span class="o">)</span>
Preparing to unpack .../python-vte_0.28.2-5ubuntu1_amd64.deb ...
Unpacking python-vte <span class="o">(</span>1:0.28.2-5ubuntu1<span class="o">)</span> ...
Selecting previously unselected package python-glade2.
Preparing to unpack .../python-glade2_2.24.0-3ubuntu3_amd64.deb ...
Unpacking python-glade2 <span class="o">(</span>2.24.0-3ubuntu3<span class="o">)</span> ...
Selecting previously unselected package guake.
Preparing to unpack .../guake_0.4.4-1ubuntu1_amd64.deb ...
Unpacking guake <span class="o">(</span>0.4.4-1ubuntu1<span class="o">)</span> ...
Processing triggers <span class="k">for</span> gconf2 <span class="o">(</span>3.2.6-0ubuntu2<span class="o">)</span> ...
Processing triggers <span class="k">for</span> man-db <span class="o">(</span>2.6.7.1-1ubuntu1<span class="o">)</span> ...
Processing triggers <span class="k">for</span> gnome-menus <span class="o">(</span>3.10.1-0ubuntu2<span class="o">)</span> ...
Processing triggers <span class="k">for</span> desktop-file-utils <span class="o">(</span>0.22-1ubuntu1<span class="o">)</span> ...
Processing triggers <span class="k">for</span> bamfdaemon <span class="o">(</span>0.5.1+14.04.20140409-0ubuntu1<span class="o">)</span> ...
Rebuilding /usr/share/applications/bamf-2.index...
Processing triggers <span class="k">for</span> mime-support <span class="o">(</span>3.54ubuntu1.1<span class="o">)</span> ...
Processing triggers <span class="k">for</span> hicolor-icon-theme <span class="o">(</span>0.13-1<span class="o">)</span> ...
Setting up python-vte <span class="o">(</span>1:0.28.2-5ubuntu1<span class="o">)</span> ...
Setting up python-glade2 <span class="o">(</span>2.24.0-3ubuntu3<span class="o">)</span> ...
Setting up guake <span class="o">(</span>0.4.4-1ubuntu1<span class="o">)</span> ...
</pre></div>


<p>در ضمن اگر دیدین بسته‌های زیادی دانلود کردین و حجم زیادی رو اشغال، از شرشون خلاص بشین!</p>
<div class="highlight"><pre><span></span>root@debian:~# apt-get clean
</pre></div>


<p>موفق باشین.</p></div>
    </article></li>
    <li><article class="post">
      <header class="post-header"><h2 class="post-title"><a href="https://mamins1376.github.io/weblog/2015/05/cron-w-rtcwake-khwb-rht/" rel="bookmark" title="cron و rtcwake: خواب راحت">cron و rtcwake: خواب راحت</a></h2>
        <abbr class="publish-date" title="تاریخ انتشار"> دوشنبه ۱۴ اردی‌بهشت ۱۳۹۴</abbr>
        <address class="vcard author">
            <a class="url fn" href="https://mamins1376.github.io/weblog/author/mhmdmyn.html">محمدامین</a>
        </address>
      </header>
      <div class="post-content"><p>دانلود شبانه یکی از باحال‌ترین کارهاست ولی دردسرهایی داره: باید سیستم رو روشن بذارین تا سر ساعت شروع کنه. <a href="http://forum.ubuntu.ir/index.php?topic=59242.0">rtcwake</a> قراره به کمک cron این مشکل رو برای همیشه برامون حل کنه تا به‌خاطر چند گیگ ناقابل از خواب‌مون نزنیم!
<!-- ادامه --></p>
<p><a href="http://forum.ubuntu.ir/index.php/topic,40582.0.html">راهنماهای خوبی</a> برای دانلود شبانه وجود دارن پس ما از اول شروع نمی‌کنیم و فقط تنظیم سیستم رو این‌جا شرح می‌دیم.<br />
<strong>نکته:</strong> rtcwake و cron هردو روی توزیع دبیان به‌طور پیش‌فرض نصبن. برای نصبش روی توزیع خودتون از مدیربسته استفاده کنین. این روش به نوع توزیع وابسته نیست.</p>
<h4>۱. کار با rtcwake</h4>
<p>چون کار با بسیاری از سخت‌افزارهای سیستم نیازمند دسترسی روت هست، rtcwake که از ساعت سخت‌افزاری سیستم استفاده می‌کنه طبیعتاً از این قاعده مستثنی نیست. پس باید کارهای مربوط به rtcwake رو با این سطح دسترسی انجام بدیم. قالب مورد نیاز ما برای روشن کردن سیستم سر ساعت <code>&lt;TIME&gt;</code> که بر حسب زمان محلی وارد می‌شه( سوییچ <code>l-</code> این کار رو انجام می‌ده) به این صورته:</p>
<div class="highlight"><pre><span></span>root@debian:~# rtcwake -l -m no -t <span class="k">$(</span> date +%s -d &lt;TIME&gt; <span class="k">)</span>
</pre></div>


<p>سوئیچ <code>m</code> به rtcwake می‌گه بعد از این که سیستم رو تنظیم کردی، هیچ‌کاری نکن(مثل خاموش کردن، حالت خواب و ...). date خروجی‌ش رو به rtcwake می‌ده که واحدش ثانیه‌ست و فاصله‌ی زمان داده‌شده رو با مبدأ زمانی یونیکس مشخص می‌کنه. مثلا ما می‌خوایم ساعت ۱ شب سیستم روشن بشه:</p>
<div class="highlight"><pre><span></span>root@debian:~# rtcwake -l -m no -t <span class="k">$(</span> date +%s -d <span class="s1">&#39;tomorrow 01:00&#39;</span> <span class="k">)</span>
</pre></div>


<p>کلمه‌ی <code>tomorrow‍</code> به date می‌فهمونه که منظور ما ساعت ۱‍ شبی‌‍ه که از ساعت ۲۴ گذشته باشه؛ یعنی اگر این دستور بعد از ساعت ۱۲ شب اجرا بشه روشن کردن سیستم رو به فردا شب موکول می‌کنه! پس دقت کنین که الان ساعت چنده.</p>
<h4>۲. افزودن به cron</h4>
<p>خود cron یک‌سری کلمه داره که رویداد خاصی رو مشخص می‌کنه. مثلا <code>reboot</code> به معنی «هر وقت سیستم روشن شد»‍ه. <strong>چه خوب!</strong> ما از این قابلیت استفاده می‌کنیم و به cron می‌گیم که هروقت سیستم روشن شد برای دانلود شبانه تنظیمش کنه. این طوری دیگه نیازی به اجرای دستی rtcwake نیست.<br />
معمولا چون cron خیلی از مسیرهای رایج رو توی متغییر محیطی <code>PATH</code> نداره مجبوریم خودمون دستی مسیر هر کدوم از اجرایی‌ها رو وارد کنیم.<br />
<strong>توجه!</strong> مسیرهایی که این‌جا برای date و rtcwake استفاده شدن ممکنه روی سیستم شما فرق کنن. با دستور <code>which</code> می‌تونید از مسیر هر دستوری مطلع بشین.  </p>
<p>اول cron مربوط به کاربر ریشه رو باز می‌کنیم:</p>
<div class="highlight"><pre><span></span>root@debian:~# crontab -u root -e
</pre></div>


<p>حالا خط زیر رو واردش می‌کنیم. توجه داشته باشین که <code>&lt;TIME&gt;</code> رو با زمان دلخواهتون عوض کنین:</p>
<div class="highlight"><pre><span></span>@reboot /usr/sbin/rtcwake -l -m no -t <span class="k">$(</span> /bin/date +<span class="se">\%</span>s -d &lt;TIME&gt; <span class="k">)</span>
</pre></div>


<p>و در انتها سیستم رو ریبوت کنین تا rtcwake ساعت رو تنظیم کنه.</p></div>
    </article></li>
    <li><article class="post">
      <header class="post-header"><h2 class="post-title"><a href="https://mamins1376.github.io/weblog/2015/05/dbyn-br-bstr-ndrwyd-pysh-bh-swy-jsyqsmt-dwm/" rel="bookmark" title="دبیان بر بستر اندروید: پیش به سوی جسی!(قسمت دوم)">دبیان بر بستر اندروید: پیش به سوی جسی!(قسمت دوم)</a></h2>
        <abbr class="publish-date" title="تاریخ انتشار"> یک‌شنبه ۱۳ اردی‌بهشت ۱۳۹۴</abbr>
        <address class="vcard author">
            <a class="url fn" href="https://mamins1376.github.io/weblog/author/mhmdmyn.html">محمدامین</a>
        </address>
      </header>
      <div class="post-content"><p>در پست قبل، بسته‌ها بارگیری و به پوشه‌ی <code>debroot</code> منتقل شدند. حالا ادامه‌ی مراحل را انجام می‌دهیم.
<!-- ادامه --></p>
<h4>۳. ساخت تصویر توزیع</h4>
<p>یک ایمیج خالی با استفاده از <code>dd</code> درست می‌کنیم:</p>
<div class="highlight"><pre><span></span>root@host:~# dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>Debian.img <span class="nv">count</span><span class="o">=</span><span class="m">0</span> <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">seek</span><span class="o">=</span>1K
</pre></div>


<p>حجم ایمیج ساخته‌شده ۱گیگابایت خواهد بود. برای داشتن اندازه‌ی دلخواهتان مقدار <code>seek</code> را بر حسب مگابایت تغییر دهید.<br />
آن را فرمت می‌کنیم:</p>
<div class="highlight"><pre><span></span>root@host:~# mkfs.ext4 -F -L Debian Debian.img
</pre></div>


<p>و سپس سوار می‌کنیم:</p>
<div class="highlight"><pre><span></span>root@host:~# mount -t ext4 -o loop,rw Debian.img /mnt
</pre></div>


<p>حالا همه‌ی بسته‌های بارگیری شده را به ایمیج کپی می‌کنیم:</p>
<div class="highlight"><pre><span></span>root@host:~# cp -r debroot/* /mnt/<span class="p">;</span> sync
</pre></div>


<p>و ایمیج را جدا:</p>
<div class="highlight"><pre><span></span>root@host:~# umount /mnt
</pre></div>


<p>حالا ما یک ایمیج از توزیع‌مان داریم ولی هنوز آماده نیست. از این‌جا دیگر به پوشه‌ی <code>debroot</code> نیاز نداریم.</p>
<h4>۴. انتقال توزیع به اندروید</h4>
<p>مهم نیست که ایمیج کجا کپی می‌شود، ولی باید قابل دسترس باشد و فضای کافی داشته باشد. مثلا ایمیج من در <code>/storage/sdcard1/Disks/</code> قرار دارد. پس از انتقال ایمیج، دیگر کاری با ماشین گنو/لینوکسی نداریم.<br />
<strong>توجه!</strong> در مرحله‌ی بعد به <a href="http://busybox.net/">BusyBox</a> نیاز خواهیم داشت. اگر هنوز آن را روی اندروید نصب نکرده‌اید، همین حالا <a href="https://play.google.com/store/apps/details?id=com.jrummy.busybox.installer">نصب کنید</a>.</p>
<h4>۵. نصب توزیع</h4>
<p>یک پوشه می‌سازیم. این پوشه محل سوارشدن ایمیج خواهد بود:</p>
<div class="highlight"><pre><span></span>root@android:~# mkdir /data/debian
root@android:~# busybox mount -o loop,rw -t ext4 &lt;IMAGE&gt; /data/debian
</pre></div>


<p>یادتان نرود که در کدهای گفته شده، <code>&lt;IMAGE&gt;</code> را با مسیر ایمیجی که کپی کردیم عوض کنید. وارد توزیع می‌شویم:</p>
<div class="highlight"><pre><span></span>root@android:~# <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
root@android:~# <span class="nb">export</span> <span class="nv">USER</span><span class="o">=</span>root
root@android:~# <span class="nb">export</span> <span class="nv">HOME</span><span class="o">=</span>/root
root@android:~# busybox chroot /data/debian /bin/bash
root@localhost:/# 
</pre></div>


<p>اکنون شما وارد توزیع شدید. اما هنوز بسته‌ها را استخراج نکردیم!</p>
<div class="highlight"><pre><span></span>root@localhost:/# /debootstrap/debootstrap --second-stage
</pre></div>


<p><code>debootstrap</code> شروع به نصب سیستم می‌کند.</p>
<p><strong>تبریک!</strong> توزیع ما آماده است؛ ولی هنوز کارهای کوچکی باقی‌مانده که می‌تواند کار ما را راحت‌تر کند. مثلا با اسکریپت زیر، هربار توزیع آماده و اجرا می‌شود و پس از اتمام کار خودبه‌خود جدا می‌شود. من [این اسکریپت][script] را در مسیر <code>system/bin/debian/</code> قرار دادم.</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">DEBMNT</span><span class="o">=</span>/data/debian
busybox mount -t ext2 &lt;IMAGE&gt; <span class="nv">$DEBMNT</span>
busybox mount -t proc none <span class="nv">$DEBMNT</span>/proc
busybox mount -t sysfs none <span class="nv">$DEBMNT</span>/sys
busybox mount -o <span class="nb">bind</span> /dev <span class="nv">$DEBMNT</span>/dev
busybox mount -t devpts none <span class="nv">$DEBMNT</span>/dev/pts
<span class="nb">unset</span> LD_PRELOAD
<span class="nv">LAST_PATH</span><span class="o">=</span><span class="nv">$PATH</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
<span class="nb">export</span> <span class="nv">USER</span><span class="o">=</span>root
<span class="nb">export</span> <span class="nv">HOME</span><span class="o">=</span>/root
<span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>linux
busybox chroot <span class="nv">$DEBMNT</span> /bin/bash
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$LAST_PATH</span>
sync
busybox umount <span class="nv">$DEBMNT</span>/dev/pts
busybox umount <span class="nv">$DEBMNT</span>/dev
busybox umount <span class="nv">$DEBMNT</span>/proc
busybox umount <span class="nv">$DEBMNT</span>/sys
busybox umount <span class="nv">$DEBMNT</span> <span class="o">||</span> sh -c busybox umount -l <span class="nv">$DEBMNT</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;Force unmounted!&#39;</span>
</pre></div>


<h4>۶. تنظیم apt</h4>
<p>لازم است که تغییراتی در <code>sources.list</code> مربوط به مدیر بسته‌ی <code>apt</code> به‌وجود آوریم تا بتوانیم بسته‌های مورد نیازمان را نصب کنیم.</p>
<div class="highlight"><pre><span></span>root@localhost:/# vi /etc/apt/sources.list
</pre></div>


<p><strong>توجه!</strong> به جای ویرایش‌گر <code>vi</code>، هر ویرایشی که با آن راحت‌تر هستید استفاده کنید. <code>nano</code> به‌طور پیش‌فرض نصب است.<br />
خطوط زیر را به آن اضافه کنید یا فایل آماده را [دریافت کنید][sources.list].</p>
<div class="highlight"><pre><span></span><span class="k">deb</span> <span class="s">http://ftp.ir.debian.org/debian/</span> <span class="kp">jessie</span> <span class="kp">contrib</span> <span class="kp">main</span> <span class="kp">non-free</span>
<span class="k">deb-src</span> <span class="s">http://ftp.ir.debian.org/debian/</span> <span class="kp">jessie</span> <span class="kp">contrib</span> <span class="kp">main</span> <span class="kp">non-free</span>

<span class="k">deb</span> <span class="s">http://ftp.ir.debian.org/debian/</span> <span class="kp">jessie-backports</span> <span class="kp">contrib</span> <span class="kp">main</span> <span class="kp">non-free</span>
<span class="k">deb-src</span> <span class="s">http://ftp.ir.debian.org/debian/</span> <span class="kp">jessie-backports</span> <span class="kp">contrib</span> <span class="kp">main</span> <span class="kp">non-free</span>

<span class="k">deb</span> <span class="s">http://ftp.ir.debian.org/debian/</span> <span class="kp">jessie-updates</span> <span class="kp">contrib</span> <span class="kp">main</span> <span class="kp">non-free</span>
<span class="k">deb-src</span> <span class="s">http://ftp.ir.debian.org/debian/</span> <span class="kp">jessie-updates</span> <span class="kp">contrib</span> <span class="kp">main</span> <span class="kp">non-free</span>
</pre></div>


<p>و در آخر،‌ برای به‌روزرسانی کَش <code>apt</code>:</p>
<div class="highlight"><pre><span></span>root@localhost:/# apt-get update
</pre></div>


<p><strong>توجه!</strong> فرمان بالا نیاز به اتصال اینترنت دارد.<br />
اکنون توزیع شما دقیقا مانند یک توزیع گنو/لینوکس عادی رفتار می‌کند.</p>
<p>در قسمت بعد به نصب محیط گرافیکی(به هر دو روش <code>framebuffer</code> و <code>VNC</code>) خواهیم پرداخت.</p>
<p>[script]: {{ site.baseurl }}/downloads/2015/05/debian
[sources.list]: {{ site.baseurl }}/downloads/2015/05/sources.list</p></div>
    </article></li>
    <li><article class="post">
      <header class="post-header"><h2 class="post-title"><a href="https://mamins1376.github.io/weblog/2015/05/dbyn-br-bstr-ndrwyd-pysh-bh-swy-jsyqsmt-wl/" rel="bookmark" title="دبیان بر بستر اندروید: پیش به سوی جسی!(قسمت اول)">دبیان بر بستر اندروید: پیش به سوی جسی!(قسمت اول)</a></h2>
        <abbr class="publish-date" title="تاریخ انتشار"> شنبه ۱۲ اردی‌بهشت ۱۳۹۴</abbr>
        <address class="vcard author">
            <a class="url fn" href="https://mamins1376.github.io/weblog/author/mhmdmyn.html">محمدامین</a>
        </address>
      </header>
      <div class="post-content"><p>بسیاری از افراد پس از خرید یک تلفن هوشمند یا تبلت، اقدام به روت کردن آن می‌کنند. مفهوم «روت» در اندروید همانند مفهوم روت در دیگر سیستم‌های گنو/لینوکسی‌ست. دلایل زیادی برای روت‌کردن وجود دارد: شخصی‌سازی بیش‌تر، حذف برنامه‌های سیستمی، اصلاح سیستم و البته نصب یک توزیع گنو/لینوکسی.<br />
در این‌جا، به نصب دبیان ۸ (جسی) بر روی یک وسیله‌ی مبتنی بر اندروید می‌پردازیم.
<!-- ادامه --></p>
<h3>چه‌چیزی لازم داریم؟</h3>
<ul>
<li>یک ماشین گنو/لینوکسی: ترجیحاً از خانواده‌ی دبیان</li>
<li>دسترسی به اینترنت یا مخزن محلی: حدود ۶۰-۷۰ مگابایت در این روش بارگیری خواهد شد.</li>
<li>تلفن هوشمند یا تبلت روت شده</li>
<li>کابل اتصال به رایانه: برای انتقال داده از ماشین گنو/لینوکسی به دستگاه</li>
<li>حداقل ۱ گیگابایت فضای خالی روی دستگاه: مهم نیست که روی حافظه‌ی داخلی باشد یا کارت SD خارجی</li>
<li>وقت و حوصله‌ی فراوان</li>
</ul>
<h3>چه قابلیت‌هایی دارد؟</h3>
<ul>
<li>اجرا به موازات اندروید بدون دستکاری سیستم</li>
<li>روان، سریع و بدون نصب هرگونه برنامه‌ی شخص سوم</li>
<li>حذف آسان</li>
<li>محیط گرافیکی(اختیاری)</li>
<li>اجرای اکثر برنامه‌های گنو/لینوکس(<a href="https://www.winehq.org/about/">WINE</a> هم شامل می‌شود!)</li>
</ul>
<h4>۱. نصب debootstrap</h4>
<p>برای نصب گنو/لینوکس از گنو/لینوکس، <code>debootstrap</code> گزینه‌ی خوبی‌ست، ایجاد یکی دیگر از صفر مطلق؛ بدون کرنل، بوت‌لودر و هرگونه بسته‌ی اختیاری.<br />
فایل‌های تولیدشده <strong>فقط</strong> شامل بسته‌های پایه‌ی سیستم می‌شود.<br />
ابتدا آن را نصب می‌کنیم:  </p>
<div class="highlight"><pre><span></span>root@host:~# apt-get install debootstrap
</pre></div>


<p>برای شروع کار با debootstrap به این اطلاعات نیازمندیم:</p>
<ul>
<li><strong>نوع پردازنده</strong>: در حال حاضر دو نوع پردازنده، غالب دستگاه‌های بازار را پوشش می‌دهند:</li>
<li><code>x86</code>: معماری کامپیوترهای ۳۲بیتی رایج</li>
<li><code>arm</code>: معماری میکروکنترلرهای پیش‌رفته و نسل جدید که خود سه نوع دارد:<ul>
<li><code>armel</code>: نسل قدیمی <code>arm</code></li>
<li><code>armhf</code>: نسل جدید <code>arm</code> که <code>armv7</code> معادل این نسل است</li>
<li><code>arm64</code>: چیپ‌های <code>arm</code> نسخه‌ی ۶۴بیتی<br />
بسته به نوع دستگاه باید یکی از ۴ مورد بالا را انتخاب کرد.</li>
</ul>
</li>
<li><strong>نسخه‌ی توزیع</strong>: ما از توزیع <a href="https://www.debian.org/">دبیان</a> نسخه‌ی <a href="https://www.debian.org/News/2015/20150426.fa.html">۸(جسی)</a> استفاده می‌کنیم. شما می‌توانید از هرنسخه‌ی دیگری(<code>stable</code>، <code>testing</code>، <code>wheezy</code>، ...) استفاده کرده یا حتی به جای دبیان، <a href="http://www.ubuntu.com/">اوبونتو</a> را امتحان کنید.</li>
<li><strong>آینه‌ی بسته‌ها</strong>: برای بارگیری بسته‌های اصلی سیستم از یک آینه استفاده می‌شود؛ این آینه می‌تواند محلی بوده یا روی ماشین دیگری باشد. فاصله‌ی جغرافیایی کمتر بین شما و آینه‌ی منتخبتان معمولاً سرعت بیش‌تری را به همراه دارد. نوع محلی از تصویر توزیع بهره می‌برد که توضیح نحوه‌ی استفاده از آن خارج از حوصله‌ی این مطلب است. ما از مخزن ایران استفاده خواهیم کرد.</li>
</ul>
<h4>۲. بارگیری پایه‌ی سیستم</h4>
<p>پوشه‌ای ایجاد می‌کنیم. این پوشه حاوی فایل‌های اصلی توزیع ما خواهد بود:</p>
<div class="highlight"><pre><span></span>root@host:~# mkdir debroot
</pre></div>


<p>سینتکس کلی برنامه‌ی <code>debootstrap</code> این است:</p>
<div class="highlight"><pre><span></span>root@host:~# debootstrap <span class="o">[</span>OPTIONS<span class="o">]</span> &lt;DIST&gt; &lt;DIR&gt; <span class="o">[</span>&lt;MIRROR&gt;<span class="o">]</span>
</pre></div>


<p>برای ما:</p>
<div class="highlight"><pre><span></span>root@host:~# debootstrap --foreign --arch<span class="o">=</span>armhf jessie ./debroot http://ftp.ir.debian.org/debian/
</pre></div>


<p>در این‌جا:</p>
<ul>
<li><code>foreign</code>: به برنامه می‌گوید که بسته‌ها را استخراج نکند، زیرا معماری ماشین هدف با معماری این ماشین متفاوت است.</li>
<li><code>arch</code>: معماری ماشین هدف(اندروید) را مشخص می‌کند که در بالا توضیح داده شد.</li>
<li><code>jessie</code>: نسخه‌ی توزیع</li>
<li><code>debroot/.</code>: نشانی پوشه‌ای که بالاتر ساختیم.</li>
<li><code>...http://ftp</code>: نشانی آینه.</li>
</ul>
<p>پس از بارگیری بسته‌ها، توزیع دریافت شده و <code>debootstrap</code> بسته‌ها را درون پوشه‌ی <code>debroot</code> خواهد ریخت.</p>
<p>در پست بعدی، بسته‌های دریافت شده را به اندروید منتقل کرده و مراحل راه‌اندازی را انجام خواهیم داد.</p></div>
    </article></li>
</ul>
<div class="pagination">
    <a href="https://mamins1376.github.io/weblog/index2.html" class="button">▶</a>

  <span class="pagination-count">صفحه ۳ از ۳</span>

    <span class="disabled button">◁</span>
</div>
</section>
    </div>

<footer class="site-footer">
<div class="wrapper">
  <div class="column-1">
    <div class="footer-title">زندگی خوره‌ای</div>
  </div>
  <div class="column-2">
    <div class="email"><a href="mailto:mamins1376@gmail.com">mamins1376@gmail.com</a></div>
    <div class="subscribe"><a href="https://mamins1376.github.io/weblog/rss.xml">اشتراک خوراک RSS</a></div>
  </div>
  <div class="column-3">
    <div class="license">
      <a target="_blank" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.fa"><img alt="مجوز کریتیو کامنز" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
    </div>
    <div class="powered-by">با افتخار، نیرو گرفته از <a href="http://getpelican.com/" title="پلیکان">پلیکان</a></div>
  </div>
</div>
</footer>
  </div>
</body>
</html>