<!DOCTYPE html>
<html lang="fa">
<head>
  <title>زندگی خوره‌ای</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/png" href="https://mamins1376.github.io/weblog/favicon.png">

  <link href="https://mamins1376.github.io/weblog/atom.xml" type="application/atom+xml" rel="alternate" title="خوراک اتم کامل زندگی خوره‌ای" />
  <link href="https://mamins1376.github.io/weblog/rss.xml" type="application/rss+xml" rel="alternate" title="خوراک آراس‌اس کامل زندگی خوره‌ای" />

      <link href="https://mamins1376.github.io/weblog/theme/css/style.css" rel="stylesheet" />
      <link href="https://mamins1376.github.io/weblog/theme/css/syntax.css" rel="stylesheet" />
      <link href="https://mamins1376.github.io/weblog/theme/css/fonts.css" rel="stylesheet" />
      <link href="https://mamins1376.github.io/weblog/theme/css/minimal.css" media="(max-width: 800px)" rel="stylesheet" />
</head>
<body class='rtl'>
  <div class='container'>

<header class="site-header">
<div class="wrapper">
  <a class="site-title" href="https://mamins1376.github.io/weblog">زندگی خوره‌ای</a>
  <span class="site-desc">نتیجه یکسری تعادل شیمیایی</span>
  <nav class="site-navigation">
    <!--a class="page-link" href="https://mamins1376.github.io/weblog/categories.html">دسته‌ها</a-->
    <!--a class="page-link" href="https://mamins1376.github.io/weblog/tags.html">برچسب‌ها</a-->

    <a href="https://github.com/mamins1376">گیت‌هاب</a>

    <a href="http://telegram.me/mamins1376">تلگرام</a>



    <a href="https://twitter.com/mamins1376">توئیتر</a>

    <a class="page-link" href="https://mamins1376.github.io/weblog/pages/drbrh/">درباره</a>
  </nav>
</div>
</header>
    <div class="wrapper">
<section class="content">
<h2>نوشته‌های دارای برچسب rtcwake</h2>

<ul class="post-list">
    <li><article class="post">
      <header class="post-header"><h2 class="post-title"><a href="https://mamins1376.github.io/weblog/2015/05/cron-w-rtcwake-khwb-rht/" rel="bookmark" title="cron و rtcwake: خواب راحت">cron و rtcwake: خواب راحت</a></h2>
        <abbr class="publish-date" title="تاریخ انتشار"> دوشنبه ۱۴ اردی‌بهشت ۱۳۹۴</abbr>
        <address class="vcard author">
            <a class="url fn" href="https://mamins1376.github.io/weblog/author/mhmdmyn.html">محمدامین</a>
        </address>
      </header>
      <div class="post-content"><p>دانلود شبانه یکی از باحال‌ترین کارهاست ولی دردسرهایی داره: باید سیستم رو روشن بذارین تا سر ساعت شروع کنه. <a href="http://forum.ubuntu.ir/index.php?topic=59242.0">rtcwake</a> قراره به کمک cron این مشکل رو برای همیشه برامون حل کنه تا به‌خاطر چند گیگ ناقابل از خواب‌مون نزنیم!
<!-- ادامه --></p>
<p><a href="http://forum.ubuntu.ir/index.php/topic,40582.0.html">راهنماهای خوبی</a> برای دانلود شبانه وجود دارن پس ما از اول شروع نمی‌کنیم و فقط تنظیم سیستم رو این‌جا شرح می‌دیم.<br />
<strong>نکته:</strong> rtcwake و cron هردو روی توزیع دبیان به‌طور پیش‌فرض نصبن. برای نصبش روی توزیع خودتون از مدیربسته استفاده کنین. این روش به نوع توزیع وابسته نیست.</p>
<h4>۱. کار با rtcwake</h4>
<p>چون کار با بسیاری از سخت‌افزارهای سیستم نیازمند دسترسی روت هست، rtcwake که از ساعت سخت‌افزاری سیستم استفاده می‌کنه طبیعتاً از این قاعده مستثنی نیست. پس باید کارهای مربوط به rtcwake رو با این سطح دسترسی انجام بدیم. قالب مورد نیاز ما برای روشن کردن سیستم سر ساعت <code>&lt;TIME&gt;</code> که بر حسب زمان محلی وارد می‌شه( سوییچ <code>l-</code> این کار رو انجام می‌ده) به این صورته:</p>
<div class="highlight"><pre><span></span>root@debian:~# rtcwake -l -m no -t <span class="k">$(</span> date +%s -d &lt;TIME&gt; <span class="k">)</span>
</pre></div>


<p>سوئیچ <code>m</code> به rtcwake می‌گه بعد از این که سیستم رو تنظیم کردی، هیچ‌کاری نکن(مثل خاموش کردن، حالت خواب و ...). date خروجی‌ش رو به rtcwake می‌ده که واحدش ثانیه‌ست و فاصله‌ی زمان داده‌شده رو با مبدأ زمانی یونیکس مشخص می‌کنه. مثلا ما می‌خوایم ساعت ۱ شب سیستم روشن بشه:</p>
<div class="highlight"><pre><span></span>root@debian:~# rtcwake -l -m no -t <span class="k">$(</span> date +%s -d <span class="s1">&#39;tomorrow 01:00&#39;</span> <span class="k">)</span>
</pre></div>


<p>کلمه‌ی <code>tomorrow‍</code> به date می‌فهمونه که منظور ما ساعت ۱‍ شبی‌‍ه که از ساعت ۲۴ گذشته باشه؛ یعنی اگر این دستور بعد از ساعت ۱۲ شب اجرا بشه روشن کردن سیستم رو به فردا شب موکول می‌کنه! پس دقت کنین که الان ساعت چنده.</p>
<h4>۲. افزودن به cron</h4>
<p>خود cron یک‌سری کلمه داره که رویداد خاصی رو مشخص می‌کنه. مثلا <code>reboot</code> به معنی «هر وقت سیستم روشن شد»‍ه. <strong>چه خوب!</strong> ما از این قابلیت استفاده می‌کنیم و به cron می‌گیم که هروقت سیستم روشن شد برای دانلود شبانه تنظیمش کنه. این طوری دیگه نیازی به اجرای دستی rtcwake نیست.<br />
معمولا چون cron خیلی از مسیرهای رایج رو توی متغییر محیطی <code>PATH</code> نداره مجبوریم خودمون دستی مسیر هر کدوم از اجرایی‌ها رو وارد کنیم.<br />
<strong>توجه!</strong> مسیرهایی که این‌جا برای date و rtcwake استفاده شدن ممکنه روی سیستم شما فرق کنن. با دستور <code>which</code> می‌تونید از مسیر هر دستوری مطلع بشین.  </p>
<p>اول cron مربوط به کاربر ریشه رو باز می‌کنیم:</p>
<div class="highlight"><pre><span></span>root@debian:~# crontab -u root -e
</pre></div>


<p>حالا خط زیر رو واردش می‌کنیم. توجه داشته باشین که <code>&lt;TIME&gt;</code> رو با زمان دلخواهتون عوض کنین:</p>
<div class="highlight"><pre><span></span>@reboot /usr/sbin/rtcwake -l -m no -t <span class="k">$(</span> /bin/date +<span class="se">\%</span>s -d &lt;TIME&gt; <span class="k">)</span>
</pre></div>


<p>و در انتها سیستم رو ریبوت کنین تا rtcwake ساعت رو تنظیم کنه.</p></div>
    </article></li>
</ul>
<div class="pagination">
    <span class="disabled button">▷</span>

  <span class="pagination-count">صفحه ۱ از ۱</span>

    <span class="disabled button">◁</span>
</div>
</section>
    </div>

<footer class="site-footer">
<div class="wrapper">
  <div class="column-1">
    <div class="footer-title">زندگی خوره‌ای</div>
  </div>
  <div class="column-2">
    <div class="email"><a href="mailto:mamins1376@gmail.com">mamins1376@gmail.com</a></div>
    <div class="subscribe"><a href="https://mamins1376.github.io/weblog/rss.xml">اشتراک خوراک RSS</a></div>
  </div>
  <div class="column-3">
    <div class="license">
      <a target="_blank" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.fa"><img alt="مجوز کریتیو کامنز" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
    </div>
    <div class="powered-by">با افتخار، نیرو گرفته از <a href="http://getpelican.com/" title="پلیکان">پلیکان</a></div>
  </div>
</div>
</footer>
  </div>
</body>
</html>